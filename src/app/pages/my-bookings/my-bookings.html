<div class="min-h-screen bg-white">
  <app-header></app-header>

  <main class="mb-container">
    <div class="mb-header">
      <div>
        <h1 class="mb-title">My Bookings</h1>
        <p class="mb-subtitle">View and manage your reservations</p>
      </div>
      <div class="mb-stats">
        <div class="stat-item">
          <lucide-icon name="calendar" class="stat-icon"></lucide-icon>
          <div class="stat-content">
            <span class="stat-value">{{ upcomingCount() }}</span>
            <span class="stat-label">Upcoming</span>
          </div>
        </div>
        <div class="stat-item">
          <lucide-icon name="check-circle-2" class="stat-icon"></lucide-icon>
          <div class="stat-content">
            <span class="stat-value">{{ completedCount() }}</span>
            <span class="stat-label">Completed</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="mb-filters">
      <button
        class="filter-btn"
        [class.active]="filter() === 'all'"
        (click)="setFilter('all')">
        All ({{ bookings().length }})
      </button>
      <button
        class="filter-btn"
        [class.active]="filter() === 'upcoming'"
        (click)="setFilter('upcoming')">
        <lucide-icon name="calendar" class="filter-icon"></lucide-icon>
        Upcoming ({{ upcomingCount() }})
      </button>
      <button
        class="filter-btn"
        [class.active]="filter() === 'completed'"
        (click)="setFilter('completed')">
        <lucide-icon name="check-circle-2" class="filter-icon"></lucide-icon>
        Completed ({{ completedCount() }})
      </button>
      <button
        class="filter-btn"
        [class.active]="filter() === 'cancelled'"
        (click)="setFilter('cancelled')">
        <lucide-icon name="x-circle" class="filter-icon"></lucide-icon>
        Cancelled ({{ cancelledCount() }})
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading()" class="mb-loading">
      <lucide-icon name="loader-2" class="loading-icon animate-spin"></lucide-icon>
      <p>Loading your bookings...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading() && filteredBookings().length === 0" class="mb-empty">
      <lucide-icon name="calendar-x" class="empty-icon"></lucide-icon>
      <h3>No bookings found</h3>
      <p>You don't have any {{ filter() === 'all' ? '' : filter() }} bookings yet.</p>
      <app-button (click)="navigateToExplore()" class="btn-explore">
        <lucide-icon name="search" class="btn-icon"></lucide-icon>
        Explore properties
      </app-button>
    </div>

    <!-- Bookings Grid -->
    <div *ngIf="!loading() && filteredBookings().length > 0" class="mb-grid">
      <div *ngFor="let booking of filteredBookings()" class="mb-card">
        <div class="mb-image">
          <img [src]="booking.propertyImage || 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800'" [alt]="booking.propertyTitle" />
          <div class="mb-badge" [ngClass]="getStatusBadgeClass(booking.status)">
            {{ booking.status }}
          </div>
        </div>
        
        <div class="mb-content">
          <h3 class="mb-booking-title">{{ booking.propertyTitle }}</h3>
          <div class="mb-location">
            <lucide-icon name="map-pin" class="mb-location-icon"></lucide-icon>
            {{ booking.propertyLocation }}
          </div>
          
          <div class="mb-details">
            <div class="mb-detail">
              <lucide-icon name="calendar" class="mb-detail-icon"></lucide-icon>
              <div class="mb-detail-content">
                <span class="mb-detail-label">Check-in</span>
                <span class="mb-detail-value">{{ formatDate(booking.checkIn) }}</span>
              </div>
            </div>
            <div class="mb-detail">
              <lucide-icon name="calendar" class="mb-detail-icon"></lucide-icon>
              <div class="mb-detail-content">
                <span class="mb-detail-label">Check-out</span>
                <span class="mb-detail-value">{{ formatDate(booking.checkOut) }}</span>
              </div>
            </div>
            <div class="mb-detail">
              <lucide-icon name="moon" class="mb-detail-icon"></lucide-icon>
              <div class="mb-detail-content">
                <span class="mb-detail-label">Duration</span>
                <span class="mb-detail-value">{{ calculateNights(booking.checkIn, booking.checkOut) }} nights</span>
              </div>
            </div>
            <div class="mb-detail">
              <lucide-icon name="users" class="mb-detail-icon"></lucide-icon>
              <div class="mb-detail-content">
                <span class="mb-detail-label">Guests</span>
                <span class="mb-detail-value">{{ booking.guests }}</span>
              </div>
            </div>
          </div>

          <div class="mb-price-section">
            <span class="mb-price-label">Total</span>
            <span class="mb-price-value">${{ booking.totalPrice | number }}</span>
          </div>

          <div class="mb-actions">
            <app-button
              variant="outline"
              size="sm"
              (click)="viewProperty(booking.propertyId)"
              class="mb-action-btn">
              <lucide-icon name="eye" class="mb-action-icon"></lucide-icon>
              View Property
            </app-button>
            <app-button
              *ngIf="booking.status === 'upcoming'"
              variant="outline"
              size="sm"
              [disabled]="cancelling() === booking.id"
              (click)="cancelBooking(booking.id)"
              class="mb-action-btn mb-action-btn-cancel">
              <lucide-icon
                [name]="cancelling() === booking.id ? 'loader-2' : 'x-circle'"
                [class.animate-spin]="cancelling() === booking.id"
                class="mb-action-icon"></lucide-icon>
              {{ cancelling() === booking.id ? 'Cancelling...' : 'Cancel' }}
            </app-button>
          </div>

          <div class="mb-meta">
            <span class="mb-meta-item">
              <lucide-icon name="calendar-days" class="mb-meta-icon"></lucide-icon>
              Booked on {{ formatDate(booking.bookingDate) }}
            </span>
            <span class="mb-meta-item">
              <lucide-icon name="hash" class="mb-meta-icon"></lucide-icon>
              {{ booking.confirmationCode }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </main>

  <app-footer></app-footer>
</div>
